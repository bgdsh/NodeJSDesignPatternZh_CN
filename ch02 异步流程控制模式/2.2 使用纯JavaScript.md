# 使用纯JavaScript
我们已经看到了第一个回调地狱的例子，这种情况是必须避免的；然而，这不是使用异步代码唯一需要关注的问题。实际上，在一些情况下，控制一组异步任务的顺序需要使用特定的模式和技术，尤其是如果我们只用纯JavaScript，而不是借助任何外部库。举个例子，遍历集合，按顺序应用异步操作并不是和在数组上触发*forEach()*一样简单，但这确实需要类似于回调的技术。
在这一节，我们不光会学到怎样避免回调地狱，而且会学到怎样使用纯JavaScript实现一些最常见的流程控制模式。
## 回调的原则
在写异步代码时，首先需要牢记的原则是定义回调时不滥用闭包。大家很容易这样做，因为不需要任何多余的思考，比如模块化和可重用性；然而，我们看到了这样做弊大于利。大多数情况下，修复回调地狱不需要任何库、复杂的技术、或者是修改方案，只需要一些常识。
下面是一些基本原则，帮助我们保证较低的嵌套级别，提高代码可组织性：

* 你必须尽快退出。使用*return*、*continue*或者*break*，基于上下文，来退出当前的声明而不是写完整的*if/else*声明。这样有助于代码层级较浅。
* 给回调命名，确保它们在闭包之外，把中间结果作为参数传递。给函数命名可以使其在栈追踪结果中看起来更清晰。
* 你需要使代码模块化。尽可能把代码分成更小的，重用度更高的函数。
## 应用回调原则

## 顺序执行

### 顺序执行已知数量的任务

### 依次遍历

#### 网络爬虫版本2

#### 按顺序爬取链接

#### 模式

## 并行执行

### 网络爬虫版本3

#### 模式

#### 修复并行任务时的竞争条件

## 有限并行执行

### 限制并发量

### 全局地限制并发量

### 使用队列

### 网络爬虫版本4




